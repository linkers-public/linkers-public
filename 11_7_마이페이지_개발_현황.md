# 11/7 마이페이지 개발 현황

## 📋 개요

프리랜서 및 기업 프로필 마이페이지 기능 구현 상태를 정리한 문서입니다.

---

## 🔵 프리랜서 프로필 페이지

### ✅ 완전 구현 (4개)

#### 1. 받은 팀 초대 (`/my/team-invites`)
- ✅ 팀 초대 목록 조회
- ✅ 팀 초대 수락/거절 기능
- ✅ 초대 상태 표시 (대기중/수락됨/거절됨)
- ✅ 매니저 정보 표시

**데이터 소스:**
- `team_members` 테이블
- `teams` 테이블
- `accounts` 테이블

---

#### 2. 받은 프로젝트 제안 (`/my/project-proposals`)
- ✅ 프로젝트 제안 목록 조회
- ✅ 프로젝트 제안 수락/거절 기능
- ✅ 제안 상태 표시 (대기중/수락됨/거절됨)
- ✅ 기업 정보 표시
- ✅ 프로젝트 상세보기 링크

**데이터 소스:**
- `project_members` 테이블
- `counsel` 테이블
- `client` 테이블

---

#### 3. 로그인/보안 (`/my/account/security`)
- ✅ 이메일 주소 표시 (읽기 전용)
- ✅ 비밀번호 변경 기능
- ✅ 계정 삭제 기능 (Soft delete)

**데이터 소스:**
- Supabase Auth API
- `accounts` 테이블 (deleted_at)

---

#### 4. 회원 탈퇴 (`/my/account/delete`)
- ✅ 탈퇴 확인 문구 입력
- ✅ Soft delete 처리
- ✅ 로그아웃 및 홈으로 이동

---

### ⚠️ 부분 구현 (3개)

#### 1. 관심 프로젝트 (`/my/bookmarked-projects`)
**구현 상태:** 테이블 생성 완료, 기능 미구현

**구현된 기능:**
- ✅ 페이지 구조 및 UI
- ✅ 빈 상태 표시

**미구현 기능:**
- ❌ 북마크 목록 조회
- ❌ 북마크 해제 기능

**데이터 소스:**
- `project_bookmarks` 테이블 ✅
- `counsel` 테이블

---

#### 2. 관심 기업 (`/my/bookmarked-companies`)
**구현 상태:** 테이블 생성 완료, 기능 미구현

**구현된 기능:**
- ✅ 페이지 구조 및 UI
- ✅ 빈 상태 표시

**미구현 기능:**
- ❌ 북마크 목록 조회
- ❌ 북마크 해제 기능

**데이터 소스:**
- `company_bookmarks` 테이블 ✅
- `accounts` 테이블

---

#### 3. 알림 설정 (`/my/account/notifications`)
**구현 상태:** 테이블 생성 완료, 기능 미구현

**구현된 기능:**
- ✅ 페이지 구조 및 UI
- ✅ Switch 컴포넌트 (이메일/웹푸시/카카오톡)
- ✅ 설정 상태 관리 (로컬)

**미구현 기능:**
- ❌ 설정 조회
- ❌ 설정 저장

**데이터 소스:**
- `user_settings` 테이블 ✅

---

## 🟢 기업 프로필 페이지

### ✅ 완전 구현 (4개)

#### 1. 내 정보 / 회사 정보 수정 (`/my/company/info`)
- ✅ 회사 정보 조회 (`client`, `accounts` 테이블)
- ✅ 회사 정보 수정 (저장)
- ✅ 회사명, 담당자, 연락처, 주소, 웹사이트 수정
- ✅ 이메일 표시 (읽기 전용)

**데이터 소스:**
- `client` 테이블 ✅ (컬럼 추가 완료: contact_person, contact_phone, address, website)
- `accounts` 테이블

**최근 업데이트:**
- 11/7: `client` 테이블에 contact_person, contact_phone, address, website 컬럼 추가 완료

---

#### 2. 진행 이력 (`/my/project-history`)
- ✅ 진행 중인 프로젝트 조회 (`counsel` 테이블)
- ✅ 프로젝트 상태 필터링
- ✅ 프로젝트 상세보기 링크
- ✅ 상태 배지 표시

**데이터 소스:**
- `counsel` 테이블
- `client` 테이블

---

#### 3. 완료 프로젝트 저장함 (`/my/completed-projects`)
- ✅ 완료된 프로젝트 조회 (`counsel` 테이블, status = 'end')
- ✅ 완료일 표시
- ✅ 프로젝트 상세보기 링크

**데이터 소스:**
- `counsel` 테이블

---

#### 4. 회원 탈퇴 (`/my/account/delete`)
- ✅ 탈퇴 확인 문구 입력
- ✅ Soft delete 처리 (`accounts.deleted_at`, `client.client_status`)
- ✅ 로그아웃 및 홈으로 이동

**데이터 소스:**
- `accounts` 테이블
- `client` 테이블

---

### ⚠️ 부분 구현 (4개)

#### 1. 팀 멤버 관리 (`/my/company/team-members`)
**구현 상태:** 테이블 생성 완료, 기능 미구현

**구현된 기능:**
- ✅ 페이지 구조 및 UI
- ✅ 멤버 추가 폼
- ✅ 멤버 목록 표시 영역

**미구현 기능:**
- ❌ 멤버 목록 조회
- ❌ 멤버 추가 기능
- ❌ 멤버 제거 기능

**데이터 소스:**
- `company_team_members` 테이블 ✅

---

#### 2. 구독 관리 (`/my/subscription`)
**구현 상태:** 테이블 생성 완료, 기능 미구현

**구현된 기능:**
- ✅ 페이지 구조 및 UI
- ✅ 구독 정보 표시 영역
- ✅ 자동 갱신 토글 UI
- ✅ 구독 해지 버튼

**미구현 기능:**
- ❌ 구독 정보 조회
- ❌ 자동 갱신 토글 기능
- ❌ 구독 해지 기능

**데이터 소스:**
- `subscriptions` 테이블 ✅

---

#### 3. 결제 내역 / 영수증 (`/my/payments`)
**구현 상태:** 테이블 생성 완료, 기능 미구현

**구현된 기능:**
- ✅ 페이지 구조 및 UI
- ✅ 결제 내역 카드 UI
- ✅ 영수증 다운로드 버튼

**미구현 기능:**
- ❌ 결제 내역 조회
- ❌ 영수증 다운로드 기능

**데이터 소스:**
- `payments` 테이블 ✅

---

#### 4. 연락처 열람 기록 (`/my/contact-history`)
**구현 상태:** 테이블 생성 완료, 기능 미구현

**구현된 기능:**
- ✅ 페이지 구조 및 UI
- ✅ 연락처 기록 카드 UI
- ✅ 프로필 보기 링크

**미구현 기능:**
- ❌ 연락처 열람 기록 조회

**데이터 소스:**
- `contact_purchases` 테이블 ✅
- `accounts` 테이블

---

## 📊 구현 상태 요약

### 전체 통계
- **완전 구현:** 8개
- **부분 구현:** 7개
- **총 페이지:** 15개

### 프리랜서 프로필
- **완전 구현:** 4개
- **부분 구현:** 3개

### 기업 프로필
- **완전 구현:** 4개
- **부분 구현:** 4개

---

## 🔧 다음 단계 작업

### 우선순위 1: 데이터 조회 기능 구현
1. 관심 프로젝트 - 북마크 목록 조회
2. 관심 기업 - 북마크 목록 조회
3. 알림 설정 - 설정 조회 및 저장
4. 구독 관리 - 구독 정보 조회 및 업데이트
5. 결제 내역 - 결제 내역 조회
6. 연락처 열람 기록 - 구매 기록 조회
7. 팀 멤버 관리 - 멤버 목록 조회

### 우선순위 2: 데이터 수정 기능 구현
1. 관심 프로젝트 - 북마크 추가/해제
2. 관심 기업 - 북마크 추가/해제
3. 팀 멤버 관리 - 멤버 추가/제거
4. 구독 관리 - 자동 갱신 토글, 구독 해지
5. 결제 내역 - 영수증 다운로드

---

## 📝 데이터베이스 스키마

### 생성 완료된 테이블
- ✅ `project_bookmarks` - 프로젝트 북마크
- ✅ `company_bookmarks` - 기업 북마크
- ✅ `user_settings` - 사용자 알림 설정
- ✅ `company_team_members` - 기업 팀 멤버
- ✅ `subscriptions` - 구독 정보
- ✅ `payments` - 결제 내역
- ✅ `contact_purchases` - 연락처 구매 기록

### 업데이트된 테이블
- ✅ `client` 테이블 컬럼 추가:
  - `contact_person` (VARCHAR)
  - `contact_phone` (VARCHAR)
  - `address` (TEXT)
  - `website` (VARCHAR)

---

## 🐛 알려진 이슈

### 1. 스키마 캐시 문제
- `client.address` 컬럼이 PostgREST 스키마 캐시에 반영되지 않음
- **해결 방법:** Supabase 대시보드에서 API 스키마 새로고침 필요
- **임시 조치:** 코드에서 address 필드를 별도로 처리하도록 수정 완료

### 2. 테이블명 불일치
- 일부 코드에서 `subscriptions` 대신 `company_subscriptions` 사용 필요할 수 있음
- 일부 코드에서 `payments` 대신 `company_payments` 사용 필요할 수 있음

---

## 📅 업데이트 이력

- **11/7:** 마이페이지 개발 현황 문서 생성
- **11/7:** `client` 테이블 컬럼 추가 (contact_person, contact_phone, address, website)
- **11/7:** 스키마 캐시 문제 해결을 위한 코드 수정

---

## 📂 페이지 구조

### 프리랜서 프로필
```
/my/team-invites          - 받은 팀 초대 ✅
/my/project-proposals     - 받은 프로젝트 제안 ✅
/my/bookmarked-projects   - 관심 프로젝트 ⚠️
/my/bookmarked-companies  - 관심 기업 ⚠️
/my/account/security      - 로그인/보안 ✅
/my/account/notifications - 알림 설정 ⚠️
/my/account/delete        - 회원 탈퇴 ✅
```

### 기업 프로필
```
/my/company/info          - 내 정보 / 회사 정보 수정 ✅
/my/company/team-members  - 팀 멤버 관리 ⚠️
/my/subscription          - 구독 관리 ⚠️
/my/payments              - 결제 내역 / 영수증 ⚠️
/my/contact-history       - 연락처 열람 기록 ⚠️
/my/project-history       - 진행 이력 ✅
/my/completed-projects    - 완료 프로젝트 저장함 ✅
/my/account/delete        - 회원 탈퇴 ✅
```

### 공통
```
/my/profile               - 내 프로필
/my/profile/manage        - 프로필 관리
/my/update                - 프로필 수정
```

